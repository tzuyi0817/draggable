var Q=Object.defineProperty,W=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var O=(e,l,t)=>l in e?Q(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,x=(e,l)=>{for(var t in l||(l={}))Y.call(l,t)&&O(e,t,l[t]);if(M)for(var t of M(l))Z.call(l,t)&&O(e,t,l[t]);return e},A=(e,l)=>W(e,X(l));import{r as v,t as ee,n as q,d as B,u as ae,a as te,h as le,w as ne,o as f,c as K,b as $,e as D,f as P,g as z,i as G,F as H,j as J,k as L,l as w,m as re}from"./index.b650c611.js";const se=e=>Array.isArray(e),oe=e=>ue(e)==="object";function ue(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function j(){return URL.createObjectURL(new Blob).slice(-36)}function E({a:e,b:l,from:t,to:d}){d?[t[e],d[l]]=[d[l],t[e]]:[t[e],t[l]]=[t[l],t[e]]}const U=new Map,m=v(void 0),p=v(void 0),y=v(null),C=v(null);function de(e,l){const t=v([]),{modelValue:d}=ee(e);U.set(l,{draggableList:t,modelValue:d});function o(s){const a=s.target.dataset.draggableArea;a!==void 0&&I(a)}function b(s){var n;const a=s.target;a.dataset.draggableId!==((n=y.value)==null?void 0:n.dataset.draggableId)&&(a.style.opacity="0.3",y.value=a)}function _(s){if(!s.dataTransfer)return;const a=s.target;s.dataTransfer.effectAllowed="move",m.value=a.dataset.draggableId,p.value=a.parentNode.dataset.draggableArea}function k(){y.value.style.opacity="1"}function N(s){var i;s.preventDefault();const a=s.target,n=a.dataset.draggableId,u=a.parentNode.dataset.draggableArea;if(u!==void 0&&u!==p.value){I(u,n);return}!n||a.dataset.draggableId===((i=C.value)==null?void 0:i.dataset.draggableId)||(C.value=a,S(n))}async function S(s){var u,i;if(!m.value||m.value===s)return;const a=t.value.findIndex(r=>r===m.value),n=t.value.findIndex(r=>r===s);if(e.animation){const{moveToBefore:r,moveToAfter:g}=e.animation,c=a<n?g:r;(u=C.value)==null||u.classList.remove(r,g),(i=C.value)==null||i.classList.add(c)}await q(),E({a,b:n,from:t.value}),E({a,b:n,from:e.modelValue})}async function I(s,a){if(!p.value)return;const{draggableList:n,modelValue:u}=U.get(p.value);p.value=s;const{draggableList:i,modelValue:r}=U.get(p.value),g=n.value.findIndex(c=>c===m.value);if(!a)h(n.value,i.value,g),h(u.value,r.value,g);else{const c=i.value.findIndex(V=>V===a);E({a:g,b:c,from:n.value,to:i.value}),E({a:g,b:c,from:u.value,to:r.value})}await q(),F()}function h(s,a,n){const[u]=s.splice(n,1);a.push(u)}function F(){y.value=document.querySelector(`[data-draggable-id='${m.value}']`),y.value.style.opacity="0.3"}function R(){t.value=e.modelValue.map(s=>j())}return{handleDragAreaEnter:o,handleDrag:b,handleDragStart:_,handleDragEnd:k,handleDragEnter:N,setDraggableList:R,draggableList:t}}const T=B({props:{tag:{default:"div"},modelValue:null,animation:null},setup(e){const l=e,t=ae(),d=te(),o=j(),{handleDragAreaEnter:b,handleDrag:_,handleDragStart:k,handleDragEnd:N,handleDragEnter:S,setDraggableList:I,draggableList:h}=de(l,o),F=B({render(){if(!!t.default)return t.default().map(a=>{var i;const n={class:d.class&&[d.class],ondragenter:b,["data-draggable-area"]:o},u=se(a.children)?(i=a.children)==null?void 0:i.map((r,g)=>{if(oe(r)){const c=R(r);return A(x({},r),{props:A(x({},r.props),{draggable:c,ondragstart:c&&k,ondrag:c&&_,ondragend:c&&N,ondragenter:c&&S,class:s(r,c),["data-draggable-id"]:h.value[g]})})}return r}):a.children;return le(l.tag,n,[A(x({},a),{children:u})])})}});function R(a){var c,V;const{draggable:n}=d;if(n===void 0||typeof n!="string")return!0;const u={".":"class","#":"id"},i=n.slice(0,1),r=n.slice(1);return((V=(c=a.props)==null?void 0:c[u[i]])!=null?V:"").split(" ").includes(r)}function s(a,n){var r;const u=(r=a.props)==null?void 0:r.class,i=n?"draggable__hover":"draggable__disable";return(u?`${u} `:"")+i}return ne(()=>l.modelValue,I,{immediate:!0}),(a,n)=>(f(),K($(F)))}});T.install=function(e){e.component("Draggable",T)};const ie=B({props:{list1:null,list2:null},setup(e){const l={moveToBefore:"draggable-drop-up",moveToAfter:"draggable-drop-down"};return(t,d)=>(f(),D("div",null,[P($(T),{tag:"ul",modelValue:e.list1,"onUpdate:modelValue":d[0]||(d[0]=o=>G(list1)?list1.value=o:null),class:"draggable",animation:l},{default:z(()=>[(f(!0),D(H,null,J(e.list1,o=>(f(),D("li",{key:o.id},[L("p",null,"id: "+w(o.name),1),L("p",null,"\u521D\u59CB\u4F4D\u7F6E: "+w(o.id),1)]))),128))]),_:1},8,["modelValue"]),P($(T),{tag:"ul",modelValue:e.list2,"onUpdate:modelValue":d[1]||(d[1]=o=>G(list2)?list2.value=o:null),class:"draggable",animation:l},{default:z(()=>[(f(!0),D(H,null,J(e.list2,o=>(f(),D("li",{key:o.id},[L("p",null,"id: "+w(o.name),1),L("p",null,"\u521D\u59CB\u4F4D\u7F6E: "+w(o.id),1)]))),128))]),_:1},8,["modelValue"])]))}}),fe=B({setup(e){const l=v([]),t=v([]);function d(o){return Array(o).fill("").map((b,_)=>({id:`${_+1}`,name:j()}))}return re(()=>{l.value=d(9)}),(o,b)=>(f(),K(ie,{list1:l.value,list2:t.value},null,8,["list1","list2"]))}});export{fe as default};
